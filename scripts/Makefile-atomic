# -*- makefile-gmake -*-


# First test if this is perhaps a compiler that implements standard
# atomic operations as of C1x.
ifeq (${ATOMIC_OPS},)
ifeq (${shell test ${STDC_VERSION} -gt 201000 && echo YES},YES)
ifneq (${DEFINE__STDC_NO_THREAD__},1)
ATOMIC_OPS := 1
CFLAGS += -DATOMIC_OPS
endif
endif
endif

# If this is not the case, test if the compiler implements the gcc
# extensions for atomic operations.
ifeq (${ATOMIC_OPS},)
ifneq (${DEFINE__GCC_HAVE_SYNC_COMPARE_AND_SWAP_4},1)
CFLAGS += -DGNUC_NO_SYNC
endif
endif
